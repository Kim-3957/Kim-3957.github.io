I"b<h1 id="칼만필터-2">칼만필터 (2)</h1>
<p>칼만필터는 예측단계와 추정(업데이트) 두개의 시퀀스를 가지는 필터이다.<br />
그런데 사실 디테일하게 이야기 하자면 할게 좀더 남았다.</p>

<blockquote>
  <ol>
    <li>대충 이전의 데이터를 가지고 다음에 들어올 입력값을 예상해놓는다 (예측단계) <br />
<strong>1.5 예측값의 분산의 계산 (공분간 계산단계)</strong></li>
    <li>입력이 들어왔다. (관측)</li>
    <li>입력데이터와 예측데이터를 비교해서 최적의 출력값을 추정 (업데이트 단계)</li>
  </ol>
</blockquote>

<h1 id="공분산이-뭔가요-먹는건가요">(공)분산이 뭔가요 먹는건가요?</h1>
<p>보통 분산하면 뭐가 떠오르는가 ?<br />
더쉽게 말하자면, 데이터의 산만한 정도이다.  <br />
어떤 정밀한 기계도 측정/예측에는 반드시 오차가 따른다.  <br />
이것은 왜냐하면 우리는 진치 (True Value) 를 알 수 없고, 불확실한 측정에 의해서 진짜값을 추정할 수 밖에 없는것이다.<br />
즉 어떠한 <strong>노이즈가 발생한다</strong>.</p>

<p>주의하라<br />
지금 <strong>우리는 측정이 아니라 모델에 의한 예측을 하는 단계이다.</strong><br />
칼만필터는 이것을 프로세스에 의한 노이즈 <code class="MathJax_Preview">w</code><script type="math/tex">w</script> (Process noise) 라고 하고 모델안에 집어넣는다.</p>

<blockquote>
  <p>왜 측정 오차가 아닌가요?</p>
</blockquote>

<p>지금은 측정에 관한 노이즈가 아니라 예측치에 관한 노이즈를 생각하고 있기떄문에 프로세스 노이즈이다.</p>

<pre class="MathJax_Preview"><code>x_k = \Phi_{k-1}x_{k-1} + w_{k-1}</code></pre>
<script type="math/tex; mode=display">x_k = \Phi_{k-1}x_{k-1} + w_{k-1}</script>

<p>이러면 의문이 생길것이다.</p>

<blockquote>
  <p>아니 우리가 노이즈를 식안에 넣을 수 있으면 진작에 넣었지…
그걸 모르니까 개고생하는거 아니야..</p>
</blockquote>

<p>라고생각할 수있다.<br />
그래서 칼만씨는 이 노이즈를 가우시안 분포를 따른다고 가정을 했다.<br />
이걸 식으로 쓰면</p>

<pre class="MathJax_Preview"><code>w_k \sim \mathcal{N}(0,Q_k)</code></pre>
<script type="math/tex; mode=display">w_k \sim \mathcal{N}(0,Q_k)</script>

<p><code class="MathJax_Preview">\mathcal{N}</code><script type="math/tex">\mathcal{N}</script> 요거는 가우시안을 따른다 라는 의미이고<br />
(평균값,분산값) 으로 표현을 한다.<br />
이렇게 되면 <strong><code class="MathJax_Preview">x_k</code><script type="math/tex">x_k</script> 자체가 가우시안 분포를 따르게 된다!</strong></p>

<p>근데 여기서 공분산이라고 하는 경우도 있다.<br />
공분산은, 아까 정의한 상태공간벡터의 분산행렬이다.<br />
여기서는 데이터의 산만한정도를 표현하는 행렬이라고만 알아두자. <br />
먼저 피부로 느껴야한다.</p>

<h1 id="측정을-해보았어요">측정을 해보았어요</h1>

<p>자 이제 실제로 측정을 하기 전에 예측을 다 해놨다.  <br />
이제는 측정을해 봤다고 하자.<br />
측정의 단계에도 우리는 모델을 이용할 필요가있다.</p>

<blockquote>
  <p>아니 측정에 모델이 필요해요?</p>
</blockquote>

<p>네, 보통 우리가 원하는 데이터는 측정값을 그대로 쓰는게아니고<br />
좌표변환이 일어난다던지 (가속도센서, 자이로센서), 값이 뻥튀기 되어서 나온다던지 (힘센서등등), <br />
즉, 우리가 생각하는대로 측정이 일어난다고 생각하지말라</p>

<p>측정값을 <code class="MathJax_Preview">z_k</code><script type="math/tex">z_k</script> 라고하자<br />
일반적인 모델의 모습은 다음과 같다.</p>

<pre class="MathJax_Preview"><code>z_k = H_k x_k + v_k</code></pre>
<script type="math/tex; mode=display">z_k = H_k x_k + v_k</script>

<p>그러니까 측정값 <code class="MathJax_Preview">z_k</code><script type="math/tex">z_k</script>을 가지고 실제의 <code class="MathJax_Preview">x_k</code><script type="math/tex">x_k</script> 를 추정하러 가는것이다.<br />
여기서도 똑같이 계측 노이즈 <code class="MathJax_Preview">v_k</code><script type="math/tex">v_k</script> 를 모델안에 집어넣은것을 알수있다.<br />
그러면 이것도 가우시안 분포를 따른다고 가정을 한다.</p>

<pre class="MathJax_Preview"><code>v_k \sim \mathcal{N}(0,R_k)</code></pre>
<script type="math/tex; mode=display">v_k \sim \mathcal{N}(0,R_k)</script>

:ET